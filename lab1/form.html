<!DOCTYPE html>

<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!--    <link href="style.css" rel="stylesheet">-->
    <link href="styleTest.css" rel="stylesheet">
    <title>Lab1</title>
</head>
<body>
<header style="font-family: monospace">
    Соловьев Артемий Александрович, P32151,<br>№813
</header>
<main>
    <div class="graph">
        <svg viewBox="0 0 400 400" xml:space="preserve">
            <g transform="matrix(1 0 0 1 200.25 200)" id="G2olelrFKNpvsyy7gWanv"  >
                <path class="figure"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(-159.75, -80)"
                      d="M 159.5 80 L 239.49999 80 L 239.49999 79.99999 L 159.49999 79.99999 L 159.49999 0 C 159.49999 0 159.49999 0 159.5 0 C 203.66 0 239.5 35.84 239.5 80 L 319.5 80 L 319.5 160 L 159.49999 160 C 157.39087 160 155.30074 159.91825 153.23257 159.75773 L 159.5 159.75773 z M 159 79.5 L 0 79.5 L 159 0.5 z"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 200 200)" id="TWkHHy4QdJv7gssQZqTEX"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)" d="M 0 -199.71831 L 0 199.71831"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 200 200)" id="1CXBQvvr2iUMVUTMsfa9x"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -199.71831 0 L 199.71831 0"
                      stroke-linecap="round" />
            </g>
            <g class="coordinate-line" transform="matrix(0.24 0 0 0.24 200 10)" id="xce5CzjLXAsJXHoxyppfQ"  >
                <path  vector-effect="non-scaling-stroke"
                       transform=" translate(-40, -40)"
                       d="M 60 40 L 80 80 L 40 80 L 0 80 L 20 40 L 40 0 L 60 40 z"
                       stroke-linecap="round" />
            </g>
            <g transform="matrix(0 0.24 -0.24 0 390.1 200)" id="JVvxtqlq3ljQ7cINsZplP"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(-40, -40)"
                      d="M 60 40 L 80 80 L 40 80 L 0 80 L 20 40 L 40 0 L 60 40 z"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 120 200)" id="8NV3QZ4q2h1N5m2oEg9dD"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 40.5 199.5)" id="Zn08bsL0MwmUGh2PjyeES"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)" d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 280.5 200.5)" id="yT7xRUcMMHDEH4hfWGY9l"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)" d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 359.5 200.5)" id="7BEEz4BsEwSfBnI1zIqWS"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(0 1 -1 0 200.5 280)" id="imbkjH1eFXXyMrcmFL9ob"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(0 1 -1 0 200.5 119.5)" id="s1x4OfFFMlonP0lVaYIrS"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(0 1 -1 0 200.5 360.5)" id="3bQDOySa6ZkxIgHfSSNa7"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(0 1 -1 0 199.5 40.5)" id="Bo_JqAM-Ju9W5BXhVRgWo"  >
                <path class="coordinate-line"
                      vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round" />
            </g>
            <g transform="matrix(1 0 0 1 229.93 120)" style="" id="b9asonbl7kFCg-ynIXc33">
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"  class="coordinates">
                    <tspan x="-13.48" y="-2.21">R</tspan>
                    <tspan x="-6.28" y="-2.21">/</tspan>
                    <tspan x="-3.6" y="-2.21">2</tspan>
                </text>
            </g>
            <g transform="matrix(1 0 0 1 293.98 180)" style="" id="YKw6xehF0ogyVttl7FM5A"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"
                      class="coordinates">
                <tspan x="-13.47" y="-2.21" >R</tspan>
                    <tspan x="-6.28" y="-2.21" >/</tspan>
                    <tspan x="-3.6" y="-2.21" >2</tspan>
            </text>
            </g>
            <g transform="matrix(1 0 0 1 133.97 231.5)" style="" id="qvTG6q9D833_U3XQrS6G2"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
                    <tspan x="-13.47" y="-2.21" >-</tspan>
                    <tspan x="-10.24" y="-2.21" >R</tspan>
                    <tspan x="-3" y="-2.21" >/</tspan>
                    <tspan x="-0.36" y="-2.21" >2</tspan>
                </text>
            </g>
            <g transform="matrix(1 0 0 1 233.97 291.5)" style="" id="EjL1xiFOCOUMGSDZgO2UO"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
                    <tspan x="-13.47" y="-2.21" >-</tspan>
                    <tspan x="-10.24" y="-2.21" >R</tspan>
                    <tspan x="-3" y="-2.21" >/</tspan>
                    <tspan x="-0.36" y="-2.21" >2</tspan>
                </text>
            </g>
            <g transform="matrix(1 0 0 1 233.97 40)" style="" id="-wlwsFcxtMlhFGOJE6Y5f"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
                    <tspan x="-13.47" y="-2.21" >R</tspan>
                </text>
            </g>
            <g transform="matrix(1 0 0 1 373.98 180)" style="" id="oMbevhHIO9N49REneAcmV"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
                    <tspan x="-13.47" y="-2.21" >R</tspan>
                </text>
            </g>
            <g transform="matrix(1 0 0 1 53.97 231.5)" style="" id="3aAW-6OCeh6F9zzH9LrxQ"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
            <tspan x="-13.47" y="-2.21" >-</tspan>
                    <tspan x="-10.24" y="-2.21" >R</tspan>
        </text>
            </g>
            <g transform="matrix(1 0 0 1 233.97 371.5)" style="" id="WFBm7R5TSuj5uyGdhCEs0"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="10" font-style="normal" font-weight="normal" letter-spacing="0.02"   class="coordinates">
            <tspan x="-13.47" y="-2.21" >-</tspan>
                    <tspan x="-10.24" y="-2.21" >R</tspan>
        </text>
            </g>
            <g transform="matrix(1 0 0 1 390 190)" style="" id="lV1zexn67qP8zU30owPzA"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="11" font-style="normal" font-weight="700"
                      letter-spacing="0.026"   class="coordinates">
            <tspan x="-9.5" y="-2.47" >X</tspan>
        </text>
            </g>
            <g transform="matrix(1 0 0 1 190 10)" style="" id="6WUUw5NDIljb22tl3nmWi"  >
                <text xml:space="preserve" font-family="Open Sans" font-size="12" font-style="normal" font-weight="700"
                      letter-spacing="0.026"  class="coordinates">
            <tspan x="-9.5" y="-2.47" >Y</tspan>
        </text>
            </g>
</svg>
    </div>
    <form class="container" method="POST">
        <h2>Проверка вхождения в область</h2>
        <div class="text-field-wrapper">
            <label for="x" class="form-label">Координата x</label>
            <input name="coordinateX" id="x" type="text" placeholder="-3...5">
        </div>
        <h4 class="form-label">Координата y</h4>
        <div class="checkbox-wrapper" name = "y">
            <input name="coordinateY" class = checkbox id="checkbox1" type="checkbox" value="-2" required >
            <label for="checkbox1">-2</label>
            <input name="coordinateY" class = checkbox id="checkbox2" type="checkbox" value="-1.5" required>
            <label for="checkbox2">-1.5</label>
            <input name="coordinateY" class = checkbox id="checkbox3" type="checkbox" value="-1" required>
            <label for="checkbox3">-1</label>
            <input name="coordinateY" class = checkbox id="checkbox4" type="checkbox" value="-0.5" required>
            <label for="checkbox4">-0.5</label>
            <input name="coordinateY" class = checkbox id="checkbox5" type="checkbox" value="0" required >
            <label for="checkbox5">0</label>
            <input name="coordinateY" class = checkbox id="checkbox6" type="checkbox" value="0.5" required>
            <label for="checkbox6">0.5</label>
            <input name="coordinateY" class = checkbox id="checkbox7" type="checkbox" value="1" required>
            <label for="checkbox7">1</label>
            <input name="coordinateY" class = checkbox id="checkbox8" type="checkbox" value="1.5" required>
            <label for="checkbox8">1.5</label>
            <input name="coordinateY" class = checkbox id="checkbox9" type="checkbox" value="2" required>
            <label for="checkbox9">2</label>
        </div>

        <h4 class="form-label">Радиус</h4>
        <div class="radio-wrapper" name = "r">
            <input name="radius" class = 'radio' id="radio10" type="radio" value="1" required>
            <label for="radio10">1</label>
            <input name="radius" class = 'radio' id="radio11" type="radio" value="1.5" required>
            <label for="radio11">1.5</label>
            <input name="radius" class = 'radio' id="radio12" type="radio" value="2" required checked>
            <label for="radio12">2</label>
            <input name="radius" class = 'radio' id="radio13" type="radio" value="2.5" required>
            <label for="radio13">2.5</label>
            <input name="radius" class = 'radio' id="radio14" type="radio" value="3" required>
            <label for="radio14">3</label>
        </div>
        <div class="btns-block">
            <button id="submitBtn" type="submit" class="btn btn-block primary" disabled>Отправить</button>
            <button id="clrBtn" type="submit" class="btn btn-block secondary">Очистить историю</button>
        </div>
    </form>
    <script type="text/javascript">
        let textInput = document.getElementById('x');
        textInput.oninput = validateForm;
        function validateForm() {
            let btn = document.getElementById('submitBtn'),
                textInput = document.getElementById('x'),
                inputVal = textInput.value;

            inputVal = inputVal.replace(',', '.');
            if ((inputVal.match(/^\d(\.\d{1,8})?$/g) || inputVal.match(/^-\d(\.\d{1,8})?$/g))  && -3 <= inputVal && inputVal <= 5) {
                textInput.classList.remove("wrong")
                textInput.classList.add("correct")
                btn.removeAttribute('disabled');
            } else {
                textInput.classList.remove("correct")
                textInput.classList.add("wrong")
                btn.setAttribute('disabled', 'true');
            }
        }
    </script>

    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function (){
            document.getElementById("submitBtn").addEventListener("click", submit)
            document.getElementById("clrBtn").addEventListener("click", () => send_ClearRequest('POST', 'clear.php'))
        })


        function submit() {
            let checkedCheckBoxes = getCheckedCheckBoxes();
            let checkedRadios = getCheckedRadio();
            for (let index = 0; index < checkedCheckBoxes.length; index++){
                let params = ''
                params = "?x=" + parseFloat(document.getElementById("x").value.replace(',','.'))
                params += "&y=" + checkedCheckBoxes[index];
                params += "&r=" + checkedRadios;
                send_request('POST', 'check.php', params)
            }


        }

        function getCheckedRadio(){
            let radios = document.getElementsByClassName('radio')
            let radiosChecked;
            for (let index = 0; index < radios.length; index++) {
                if (radios[index].checked) {
                    radiosChecked= radios[index].value;
                }
            }
            return radiosChecked;
        }
        function getCheckedCheckBoxes(){
            let checkboxes = document.getElementsByClassName('checkbox');
            let checkboxesChecked = [];
            for (let index = 0; index < checkboxes.length; index++) {
                if (checkboxes[index].checked) {
                    checkboxesChecked.push(checkboxes[index].value);
                }
            }
            return checkboxesChecked;
        }

        function send_request(method, url, params) {
            new Promise((resolve, reject) => {
                let xhr = new XMLHttpRequest()
                xhr.open(method, url + params)
                xhr.onload = () => {
                    if (xhr.status >= 400)
                        reject()
                    else
                        resolve(xhr)
                }
                xhr.onerror = () => {
                    reject(xhr)
                }
                xhr.send()
            }).then(xhr => {
                let response = xhr.responseText
                if (response !== "") document.querySelector(".result_table").innerHTML = response
                else alert("Error in the request!")
            }).catch((xhr) => {
                if (xhr.status === 400) alert("Error in the request!")
                else alert("Unknown error")
            })
        }
        function send_ClearRequest(method, url) {
            new Promise((resolve, reject) => {
                let xhr = new XMLHttpRequest()
                xhr.open(method, url)
                xhr.onload = () => {
                    if (xhr.status >= 400)
                        reject()
                    else
                        resolve(xhr)
                }
                xhr.onerror = () => {
                    reject(xhr)
                }
                xhr.send()
            }).then(xhr => {
                let response = xhr.responseText
                if (response !== "") document.querySelector(".result_table").innerHTML = response
                else alert("Error in the request!")
            }).catch((xhr) => {
                if (xhr.status === 400) alert("Error in the request!")
                else alert("Unknown error")
            })
        }

    </script>
</main>


<table class="result_table">
    <tr>
        <th class="vars_table">X</th>
        <th class="vars_table">Y</th>
        <th class="vars_table">R</th>
        <th>Result</th>
        <th>Submit time</th>
        <th>Calculation time</th>
    </tr>
</table>

</body>
</html>