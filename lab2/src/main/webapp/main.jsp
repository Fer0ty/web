<%@ page import="utils.TableRow" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>lab2</title>
    <link rel="stylesheet" href="css/main.css" type="text/css">
</head>
<body>
<header style="font-family: monospace">
    Соловьев Артемий Александрович, P32151,<br>№124421
</header>
<main class="mt-75">
    <div class="graph">
        <svg id="image" viewBox="0 0 400 400" xml:space="preserve">
            <title>Layer 1</title>
            <g  class = "figure" transform="matrix(1 0 0 1 200.25 240)" id="-TXYfJ9Ik3MH4052l38lD"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(-159.75, -120)"
                      d="M 319.5 80 L 319.5 240 L 159.5 240 L 159.5 0 C 203.66 0 239.5 35.84 239.5 79.99999 L 239.5
                          80 z M 159 239.5 L 0 80.5 L 159 80.5 z"
                      stroke-linecap="round"></path>
            </g>

            <g  class = "coordinate-line" transform="matrix(1 0 0 1 200 200)" id="rf8-EmpusOp8W8KnftDHI"  >
                <path  vector-effect="non-scaling-stroke"
                       transform=" translate(0, 0)"
                       d="M 0 -200 L 0 200"
                       stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(1 0 0 1 200 200)" id="48g0JhZN95-oZXY7_jzFz"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -200 0 L 200 0"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(0.24 0 0 0.24 200 10)" id="a3OzARVGkIGvtRxmtgDx5"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(-40, -40)"
                      d="M 60 40 L 80 80 L 40 80 L 0 80 L 20 40 L 40 0 L 60 40 z"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(0 0.24 -0.24 0 389.9 200)" id="hys6LMuES8FHcNdGw780g"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(-40, -40)"
                      d="M 60 40 L 80 80 L 40 80 L 0 80 L 20 40 L 40 0 L 60 40 z"
                      stroke-linecap="round"></path>
            </g>

            <g class="coordinate-line" transform="matrix(1 0 0 1 200 120)" id="pGfa-ExDm8L4j-6iMlWqG"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -20 0 L 20 0"
                      stroke-linecap="round"></path>
            </g>

            <g class="coordinate-line" transform="matrix(1 0 0 1 280 200)" id="1W2ztNHVsdDXle1uymVRA"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round"></path>
            </g>

            <g class="coordinate-line" transform="matrix(1 0 0 1 120 200)" id="rmxh3PDXEJn37tNcceQph"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(1 0 0 1 200 280)" id="xrS3Z665jzp0yVdMhQKue"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -20 0 L 20 0"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(1 0 0 1 40 200)" id="FhkBEBuCGIBpPDErMkbOv"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(1 0 0 1 200 40)" id="lmCmJC8X9jQ5IIkVqPuQX"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -20 0 L 20 0"
                      stroke-linecap="round"></path>
            </g>

            <g class = "coordinate-line" transform="matrix(1 0 0 1 360 200)" id="kbej--Upzf0pSMMqFtzVn"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M 0 -20 L 0 20"
                      stroke-linecap="round"></path>
            </g>
            <g class = "coordinate-line" transform="matrix(1 0 0 1 200 360)" id="o9Mmbn2g2P0ioOkPToCMU"  >
                <path vector-effect="non-scaling-stroke"
                      transform=" translate(0, 0)"
                      d="M -20 0 L 20 0"
                      stroke-linecap="round"></path>
            </g>



            <g transform="matrix(1 0 0 1 230 110)" id="73mCD8690cnDNUqQ1WJMp">
                <text class="coordinates" id="svg_1" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve">
                        <tspan x="-10.92" y="2.81">R</tspan>
                    <tspan x="-0.5" y="2.81">/</tspan>
                    <tspan x="2.91" y="2.81">2</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 291.42 170)" style="" id="hIFdErFXqeBIRCwQiNvBK"  >
                <text  class="coordinates" id="svg_2" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve">
                        <tspan x="-10.92" y="2.81" >R</tspan>
                    <tspan x="-0.5" y="2.81" >/</tspan>
                    <tspan x="2.91" y="2.81" >2</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 231.42 290)" style="" id="JgDHW0kxl4zr2xsxvpLLO">
                <text class="coordinates" id="svg_3" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-13.18" y="2.81" >-</tspan>
                    <tspan x="-8.65" y="2.81" >R</tspan>
                    <tspan x="2" y="2.81" >/</tspan>
                    <tspan x="5.18" y="2.81" >2</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 131.42 170)" style="" id="A3BFjqv7z2urjz_S2topx"  >
                <text class="coordinates" id="svg_4" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-13.18" y="2.81" >-</tspan>
                    <tspan x="-8.65" y="2.81" >R</tspan>
                    <tspan x="2" y="2.81" >/</tspan>
                    <tspan x="5.18" y="2.81" >2</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 230 30)" style="" id="UVAioQObMKf6o2WqZ6z52"  >
                <text class="coordinates" id="svg_5" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-9.5" y="2.81" >R</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 370 170)" style="" id="ZzGUxUV37OtEcKGVIIZdK"  >
                <text class="coordinates" id="svg_6" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve"  >
                        <tspan x="-9.5" y="2.81" >R</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 50 170)" style="" id="dsh29KjSGhZ9BrFInTZsa"  >
                <text class="coordinates" id="svg_7" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve"  >
                        <tspan x="-9.5" y="2.81" >-</tspan>
                    <tspan x="-4.97" y="2.81" >R</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 230 370)" style="" id="UeF1qv-xqjdUIR8rEaE5E"  >
                <text class="coordinates" id="svg_8" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-9.5" y="2.81" >-</tspan>
                    <tspan x="-4.97" y="2.81" >R</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 220 20)" style="" id="feGtskf8faOeJM8zI1Rbx"  >
                <text class="coordinates" id="svg_9" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-7.5" y="2.81" >Y</tspan>
                    </text>
            </g>

            <g transform="matrix(1 0 0 1 386.93 180)" style="" id="vqH8wmM6IQEEdzSRfyNfh"  >
                <text class="coordinates" id="svg_10" fill-rule=" nonzero" fill=" rgb(0,0,0)" stroke-miterlimit="4" stroke-linejoin=" miter" stroke-dashoffset="0" stroke-linecap=" butt" stroke-dasharray=" none" stroke=" none" letter-spacing="0.026" font-weight="700" font-style="normal" font-size="14" font-family="Open Sans" xml:space="preserve" >
                        <tspan x="-9.5" y="2.81" >X</tspan>
                    </text>
            </g>


            <title>Layer 2</title>
            <points id = "points">

            </points>
        </svg>
    </div>

    <form class="container" action="control" method="GET">
        <h2>Проверка вхождения в область</h2>
        <div class="text-field-wrapper">
            <label for="XInput" class="form-label">Координата X</label>
            <input name="coordinateX" id="XInput" type="text" placeholder="-5...3"  onchange="validateForm()">
        </div>
        <div class="text-field-wrapper">
            <label for="YInput" class="form-label">Координата Y</label>
            <input name="coordinateY" id="YInput" type="text" placeholder="-3...3"  onchange="validateForm()">
        </div>
        <div class="text-field-wrapper">
            <label for="RInput" class="form-label">Радиус</label>
            <input name="radius" id="RInput" type="text" placeholder="2...5"  onchange="validateForm()">
        </div>

        <div class="btns-block">
            <a class="btn btn-block secondary" href="table.jsp">Таблица</a>
            <button id="submitBtn" class="btn btn-block primary" disabled>Отправить</button>
        </div>
    </form>

    <form id="jsForm" action="control" method="GET">
        <input id="rField" name="radius" type="hidden">
        <input id="xField" name="coordinateX" type="hidden">
        <input id="yField" name="coordinateY" type="hidden">
    </form>

<script>
    let image = document.getElementById("image"),
        radiusInputs = document.getElementsByName("radius");
    image.onclick = function (e) {
        let target = this.getBoundingClientRect();
        let x = (e.clientX - target.left - target.width/2) / (target.width / 2.5),
            y = -(e.clientY - target.top - target.height/2) / (target.height / 2.5) + 0.0025;

        let radius = 1;
        for (const radiusInput of radiusInputs) {
            if (2 <= radiusInput.value && radiusInput.value <= 5) {
                radius = radiusInput.value;
            }
        }
        if (radius < 2 || radius > 5){
            alert("R must take a value from 2 to 5")
        } else {
            let form = document.getElementById("jsForm"),
                xField = document.getElementById("xField"),
                yField = document.getElementById("yField"),
                rField = document.getElementById("rField");
            xField.value = (x*radius).toFixed(4).toString();
            yField.value = (y*radius).toFixed(4).toString();
            rField.value = radius.toString();
            let pointX = 200 + x*200 - 40 * x, pointY = 200 - y*200 + 40*y;
            form.submit();
        }
    }
</script>

    <jsp:useBean id="table" type="utils.TableBean" scope="session"/>
    <div id="dataSet" style="display: none">
        <% if (table != null) { %>
        <%=table.getPointsAsText()%>
        <% } %>
    </div>

    <script src="JS/main.js" type="text/javascript"></script>
    <script src="JS/plot.js" type="text/javascript"></script>
</main>
</body>
</html>
